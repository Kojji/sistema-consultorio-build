(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[9],{9697:function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("q-dialog",{attrs:{persistent:""},model:{value:t.OpenModalEdit,callback:function(e){t.OpenModalEdit=e},expression:"OpenModalEdit"}},[a("div",[a("q-form",{ref:"event",on:{submit:t.onSubmit}},[t.OpenModalEdit?a("q-card",{staticStyle:{width:"400px"}},[a("q-toolbar",{staticClass:"bg-primary text-white"},[a("q-toolbar-title",[t._v("\n            "+t._s(t.isNewEvent?"Novo":"Editar")+" Evento\n          ")]),a("q-btn",{attrs:{flat:"",round:"",color:"white",icon:"close"},on:{click:t.closeModal}})],1),a("q-card-section",{staticClass:"inset-shadow"},[a("q-input",{attrs:{label:"Titulo",rules:[function(t){return t&&t.length>0||"Campo obrigatório"}],autofocus:""},model:{value:t.eventForm.title,callback:function(e){t.$set(t.eventForm,"title",e)},expression:"eventForm.title"}}),a("q-input",{attrs:{autogrow:"",label:"Detalhes"},model:{value:t.eventForm.details,callback:function(e){t.$set(t.eventForm,"details",e)},expression:"eventForm.details"}}),a("q-input",{attrs:{label:"Data",disable:""},model:{value:t.inputDate,callback:function(e){t.inputDate=e},expression:"inputDate"}}),a("q-checkbox",{staticClass:"q-my-sm",attrs:{label:"Usar dia inteiro?"},model:{value:t.eventForm.allDay,callback:function(e){t.$set(t.eventForm,"allDay",e)},expression:"eventForm.allDay"}}),t.eventForm.allDay?t._e():a("div",{staticClass:"row q-gutter-xs"},[a("q-input",{ref:"dateTimeStart",staticClass:"col",attrs:{label:"Início",rules:[function(e){return t.checkDateTimeDiff()||"Hora de Início maior que a de Término"},function(e){return t.checkDateTimeStart()||"Hora de Início Inválida"}],outlined:"",color:"blue-6"},model:{value:t.eventForm.dateTimeStart,callback:function(e){t.$set(t.eventForm,"dateTimeStart",e)},expression:"eventForm.dateTimeStart"}}),a("q-input",{ref:"dateTimeEnd",staticClass:"col",attrs:{label:"Término",rules:[function(e){return t.checkDateTimeDiff()||"Hora de Início maior que a de Término"},function(e){return t.checkDateTimeEnd()||"Hora de Término Inválida"}],color:"blue-6",outlined:""},model:{value:t.eventForm.dateTimeEnd,callback:function(e){t.$set(t.eventForm,"dateTimeEnd",e)},expression:"eventForm.dateTimeEnd"}})],1),a("q-input",{attrs:{label:"Cor",outlined:"",rules:[function(t){return t&&t.length>0||"Campo obrigatório"}]},scopedSlots:t._u([{key:"prepend",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",style:t.setColor(),attrs:{name:"format_color_fill"}})]},proxy:!0},{key:"append",fn:function(){return[a("q-icon",{staticClass:"cursor-pointer",attrs:{name:"colorize"}},[a("q-popup-proxy",[a("q-color",{attrs:{"no-header":"","no-footer":"","default-view":"palette"},model:{value:t.eventForm.bgcolor,callback:function(e){t.$set(t.eventForm,"bgcolor",e)},expression:"eventForm.bgcolor"}})],1)],1)]},proxy:!0}],null,!1,1266467321),model:{value:t.eventForm.bgcolor,callback:function(e){t.$set(t.eventForm,"bgcolor",e)},expression:"eventForm.bgcolor"}})],1),a("q-card-actions",{attrs:{align:"right"}},[t.newEvent?t._e():a("q-btn",{attrs:{flat:"",label:"Excluir",color:"negative"},on:{click:t.deleteEvent}}),a("q-btn",{attrs:{flat:"",label:"Fechar",type:"reset",color:"primary"},on:{click:t.closeModal}}),a("q-btn",{attrs:{flat:"",label:"Salvar",type:"submit",color:"primary"}})],1)],1):t._e()],1)],1)])},i=[],o=a("c973"),r=a.n(o),s=a("ded3"),l=a.n(s),m=(a("96cf"),a("99af"),a("ac1f"),a("841c"),a("d3b7"),a("e6cf"),a("a79d"),a("fe7a")),c={title:"",details:"",allDay:!1,date:"",patientId:null,dateTimeStart:"",dateTimeEnd:"",bgcolor:"#66b3ff"},d={props:{OpenModal:{type:Boolean,default:!1},newEvent:{type:Boolean,default:!1}},data:function(){return{eventForm:l()({},c),contextDay:null,locale:"pt-br",showDateTimeScrollerStart:!1,showDateTimeScrollerEnd:!1,showDateScrollerAllDay:!1,appointmentId:null,pacientes:[],search:null,loadingSearch:!1}},computed:{OpenModalEdit:{get:function(){return this.OpenModal}},isNewEvent:{get:function(){return this.newEvent}},inputDate:{get:function(){var t=new Date("".concat(this.eventForm.date," 12:00"));return"".concat(t.getDate()<10?"0".concat(t.getDate()):t.getDate(),"/").concat(t.getMonth()+1<10?"0".concat(t.getMonth()+1):t.getMonth()+1,"/").concat(t.getFullYear())}}},methods:{closeModal:function(){this.$emit("closeModal")},changeTitle:function(){console.log(this.search)},setColor:function(){return"color: ".concat(this.eventForm.bgcolor)},resetForm:function(){this.$set(this,"eventForm",l()({},c))},getForms:function(t){var e=this;this.loadingSearch=!0,this.$axios.get("/patients/name",{params:{page:1,active:!0,search:t}}).then((function(t){t.data.success&&(e.pacientes=t.data.patients)})).finally((function(){e.loadingSearch=!1}))},filterFn:function(t,e){var a=this;e(""!==t?r()(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a.getForms(t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))):function(){a.pacientes=[]})},adjustTimestamp:function(t){return t.minute<15?t.minute=0:t.minute<30?t.minute=15:t.minute<45?t.minute=30:t.minute=45,t.time=m["a"].getTime(t),t},checkDateTimeDiff:function(){if(this.$refs.dateTimeStart.resetValidation(),this.$refs.dateTimeEnd.resetValidation(),this.eventForm.dateTimeStart&&this.eventForm.dateTimeEnd){var t=m["a"].parseTimestamp(this.eventForm.date+" "+this.eventForm.dateTimeStart),e=m["a"].parseTimestamp(this.eventForm.date+" "+this.eventForm.dateTimeEnd),a=m["a"].diffTimestamp(t,e,!0);return 0!==a}return!1},checkDateTimeEnd:function(t){if(this.eventForm.dateTimeEnd){var e=m["a"].parseTimestamp(this.eventForm.date+" "+this.eventForm.dateTimeEnd),a=m["a"].parseTimestamp(this.eventForm.date+" "+this.agendaTimeLimit),n=m["a"].diffTimestamp(e,a,!1);return!(n<0)}return!1},checkDateTimeStart:function(){if(this.eventForm.dateTimeStart){var t=m["a"].parseTimestamp(this.eventForm.date+" "+this.agendaTimeStart),e=m["a"].parseTimestamp(this.eventForm.date+" "+this.eventForm.dateTimeStart),a=m["a"].diffTimestamp(t,e,!1);return!(a<0)}return!1},deleteEvent:function(){var t=this,e=this.$store.getters["agenda/getEditEvent"],a={active:!1,title:e.title,details:e.details,PatientId:e.PatientId,bgcolor:e.bgcolor,duration:e.duration,date:e.date,time:e.time};this.$axios.put("appointments/appointment/"+this.appointmentId,a).then((function(e){t.$q.notify({message:e.data.message,color:"green",position:"top-right"}),t.$emit("repaginate"),t.closeModal()}))},onSubmit:function(){var t=this,e={};if(e.title=this.eventForm.title,e.details=this.eventForm.details,e.PatientId=this.search,e.date=this.eventForm.date,e.bgcolor=this.eventForm.bgcolor,e.active=!0,this.eventForm.allDay)e.time=this.agendaTimeStart,e.duration=this.agendaDayDuration;else{e.time=this.eventForm.dateTimeStart;var a=m["a"].parseTimestamp(this.eventForm.date+" "+this.eventForm.dateTimeEnd),n=m["a"].parseTimestamp(this.eventForm.date+" "+this.eventForm.dateTimeStart),i=m["a"].diffTimestamp(n,a,!1);e.duration=i/6e4}this.newEvent?this.$axios.post("appointments",e).then((function(e){t.$q.notify({message:e.data.message,color:"green",position:"top-right"}),t.$emit("repaginate"),t.closeModal()})):this.$axios.put("appointments/appointment/"+this.appointmentId,e).then((function(e){t.$q.notify({message:e.data.message,color:"green",position:"top-right"}),t.$emit("repaginate"),t.closeModal()}))}},mounted:function(){if(this.resetForm(),this.newEvent){var t=this.$store.getters["agenda/getEditScope"];this.contextDay=l()({},t.timestamp),this.eventForm.date=this.contextDay.date;var e=this.adjustTimestamp(this.contextDay),a=m["a"].addToDate(e,{hour:1});this.eventForm.dateTimeEnd=m["a"].getTime(a),this.eventForm.dateTimeStart=m["a"].getTime(e),this.eventForm.allDay=!1,this.eventForm.PacientId=null,this.eventForm.bgcolor="#66b3ff"}else{var n=this.$store.getters["agenda/getEditEvent"];this.appointmentId=n.id,this.eventForm.date=n.date,this.eventForm.title=n.title,this.eventForm.details=n.details;var i=m["a"].parsed(n.date+" "+n.time),o=m["a"].addToDate(i,{minute:n.duration});this.eventForm.dateTimeEnd=m["a"].getTime(o),this.eventForm.dateTimeStart=n.time,this.eventForm.PatientId=n.PatientId,this.eventForm.allDay=n.duration===this.agendaDayDuration,this.eventForm.bgcolor=n.bgcolor}}},u=d,p=a("2877"),h=a("24e8"),v=a("0378"),f=a("f09f"),g=a("65c6"),F=a("6ac5"),T=a("9c40"),b=a("a370"),D=a("27f9"),E=a("ddd8"),y=a("66e5"),S=a("4074"),x=a("8f8e"),q=a("0016"),w=a("7cbe"),k=a("b498"),$=a("4b7e"),I=a("eebe"),C=a.n(I),M=Object(p["a"])(u,n,i,!1,null,null,null);e["default"]=M.exports;C()(M,"components",{QDialog:h["a"],QForm:v["a"],QCard:f["a"],QToolbar:g["a"],QToolbarTitle:F["a"],QBtn:T["a"],QCardSection:b["a"],QInput:D["a"],QSelect:E["a"],QItem:y["a"],QItemSection:S["a"],QCheckbox:x["a"],QIcon:q["a"],QPopupProxy:w["a"],QColor:k["a"],QCardActions:$["a"]})}}]);